# ‚ö° –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞ 5 –º–∏–Ω—É—Ç

## 1Ô∏è‚É£ –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ: **`backtest_optana_v4.py`**

```
backtest/
‚îî‚îÄ‚îÄ core/
    ‚îî‚îÄ‚îÄ backtest_optana_v4.py  ‚Üê –í–°–Ø –ù–ê–°–¢–†–û–ô–ö–ê –ó–î–ï–°–¨
```

---

## 2Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞)

### –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã

```python
# –°—Ç—Ä–æ–∫–∞ ~45
RUN_MODE = "SINGLE"    # –∏–ª–∏ "OPTIMIZE"
```

- **"SINGLE"** - –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–¥–Ω—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
- **"OPTIMIZE"** - –Ω–∞–π—Ç–∏ –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

```python
# –°—Ç—Ä–æ–∫–∞ ~48
TARGET_CONFIG_NAME = "EMA_RSI_ATR_Strategy"
```

### –ú–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

```python
# –°—Ç—Ä–æ–∫–∞ ~51
OPTIMIZATION_METRIC = "Sharpe Ratio"
```

–í–∞—Ä–∏–∞–Ω—Ç—ã: `"Total PnL"`, `"Return (%)"`, `"Sharpe Ratio"`, `"Max Drawdown (%)"`

---

## 3Ô∏è‚É£ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

```python
# –°—Ç—Ä–æ–∫–∞ ~60
PARAMETER_SPACE = {
    "EMA_TREND": {
        "fast_len": [5, 9, 13],        # –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è
        "slow_len": [21, 34, 50],
    },
    "RSI": {
        "rsi_len": [14, 20],
    },
    "EXIT": {
        "target_roi_percent": [0.5, 1.0],
        "risk_roi_percent": [0.5, 0.8],
    },
}
```

**–í–∞–∂–Ω–æ**: –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –í–°–ï –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (3√ó3√ó2√ó2√ó2 = 72 –≤–∞—Ä–∏–∞–Ω—Ç–∞)

---

## 4Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

```python
# –°—Ç—Ä–æ–∫–∞ ~75
STRATEGY_CONFIGS = {
    "EMA_RSI_ATR_Strategy": StrategyConfig(...),  # –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è
    
    # –î–û–ë–ê–í–¨–¢–ï –°–í–û–Æ:
    "My_Strategy": StrategyConfig(
        initial_capital=10000.0,        # –ù–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª
        leverage=10.0,                   # –ü–ª–µ—á–æ
        target_roi_percent=0.8,          # Take Profit %
        risk_roi_percent=0.5,            # Stop Loss %
        indicator_set={
            "EMA_TREND": {
                "fast_len": 9, 
                "slow_len": 21
            },
            "RSI": {
                "rsi_len": 14,
                "overbought": 70,
                "oversold": 30
            },
        },
    ),
}
```

–ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```python
TARGET_CONFIG_NAME = "My_Strategy"
```

---

## 5Ô∏è‚É£ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ - —á—Ç–æ –æ–Ω–∏ –æ–∑–Ω–∞—á–∞—é—Ç

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è |
|----------|------------|------------------------|
| `initial_capital` | –ù–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª | 1000-10000 USD |
| `leverage` | –ü–ª–µ—á–æ (–º–Ω–æ–∂–∏—Ç–µ–ª—å) | 5-20x |
| `target_roi_percent` | Take Profit –æ—Ç —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞ | 0.5-2.0% |
| `risk_roi_percent` | Stop Loss –æ—Ç —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞ | 0.3-1.0% |

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã

#### EMA_TREND (–°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ)
```python
"EMA_TREND": {
    "fast_len": 9,      # –ë—ã—Å—Ç—Ä–∞—è –ª–∏–Ω–∏—è (5-20)
    "slow_len": 21,     # –ú–µ–¥–ª–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è (20-100)
}
```
- **–í—Ö–æ–¥ Long**: –ö–æ–≥–¥–∞ –±—ã—Å—Ç—Ä–∞—è EMA –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω—É—é –í–í–ï–†–•
- **–í—Ö–æ–¥ Short**: –ö–æ–≥–¥–∞ –±—ã—Å—Ç—Ä–∞—è EMA –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω—É—é –í–ù–ò–ó

#### RSI (–ò–Ω–¥–µ–∫—Å —Å–∏–ª—ã)
```python
"RSI": {
    "rsi_len": 14,       # –ü–µ—Ä–∏–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ (7-30)
    "overbought": 70,    # –ü–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å (65-80)
    "oversold": 30,      # –ü–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å (20-35)
}
```
- **Long**: –ö–æ–≥–¥–∞ RSI < 30 (—Ä—ã–Ω–æ–∫ –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω)
- **Short**: –ö–æ–≥–¥–∞ RSI > 70 (—Ä—ã–Ω–æ–∫ –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω)

#### ATR_EXIT (–°—Ä–µ–¥–Ω–∏–π –∏—Å—Ç–∏–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω)
```python
"ATR_EXIT": {
    "atr_len": 14,          # –ü–µ—Ä–∏–æ–¥ ATR (10-20)
    "atr_multiplier": 1.5,  # –ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–ª—è —Å—Ç–æ–ø–æ–≤ (1.0-3.0)
}
```
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö Stop Loss

---

## 6Ô∏è‚É£ –ü—Ä–∏–º–µ—Ä—ã –≥–æ—Ç–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### üèÉ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Å–∫–∞–ª—å–ø–∏–Ω–≥

```python
"Aggressive_Scalper": StrategyConfig(
    initial_capital=10000.0,
    leverage=20.0,              # –í—ã—Å–æ–∫–æ–µ –ø–ª–µ—á–æ
    target_roi_percent=0.3,     # –£–∑–∫–∏–π TP
    risk_roi_percent=0.2,       # –£–∑–∫–∏–π SL
    indicator_set={
        "EMA_TREND": {"fast_len": 5, "slow_len": 13},  # –ë—ã—Å—Ç—Ä—ã–µ EMA
        "RSI": {"rsi_len": 5},                          # –ë—ã—Å—Ç—Ä—ã–π RSI
    },
)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–∞–π–º—Ñ—Ä–µ–π–º (1m-5m)

### üê¢ –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è

```python
"Conservative": StrategyConfig(
    initial_capital=10000.0,
    leverage=5.0,               # –ù–∏–∑–∫–æ–µ –ø–ª–µ—á–æ
    target_roi_percent=2.0,     # –®–∏—Ä–æ–∫–∏–π TP
    risk_roi_percent=1.0,       # –®–∏—Ä–æ–∫–∏–π SL
    indicator_set={
        "EMA_TREND": {"fast_len": 21, "slow_len": 50},  # –ú–µ–¥–ª–µ–Ω–Ω—ã–µ EMA
        "RSI": {"rsi_len": 14},
        "MACD": {"fast_len": 12, "slow_len": 26, "signal_len": 9},
    },
)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, –¥–ª–∏–Ω–Ω—ã–π —Ç–∞–π–º—Ñ—Ä–µ–π–º (15m-1h)

### üí• –ü—Ä–æ–±–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

```python
"Breakout": StrategyConfig(
    initial_capital=10000.0,
    leverage=10.0,
    target_roi_percent=1.5,
    risk_roi_percent=0.8,
    indicator_set={
        "EMA_TREND": {"fast_len": 13, "slow_len": 34},
        "ATR_EXIT": {"atr_len": 14, "atr_multiplier": 2.0},
        "BOLLINGER_BANDS": {"bb_len": 20, "num_dev": 3.0},
    },
)
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –û–∂–∏–¥–∞–µ—Ç—Å—è —Å–∏–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏

---

## 7Ô∏è‚É£ –ó–∞–ø—É—Å–∫

### –û–¥–∏–Ω–æ—á–Ω—ã–π –ø—Ä–æ–≥–æ–Ω

```python
RUN_MODE = "SINGLE"
TARGET_CONFIG_NAME = "My_Strategy"
```

```bash
python -m backtest.core.backtest_optana_v4
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

```python
RUN_MODE = "OPTIMIZE"
TARGET_CONFIG_NAME = "My_Strategy"
OPTIMIZATION_METRIC = "Sharpe Ratio"

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞
PARAMETER_SPACE = {
    "EMA_TREND": {
        "fast_len": [5, 9, 13],
        "slow_len": [21, 34, 50],
    },
    "RSI": {
        "rsi_len": [14, 20],
    },
}
```

```bash
python -m backtest.core.backtest_optana_v4
```

---

## 8Ô∏è‚É£ –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ       –ú–µ—Ç—Ä–∏–∫–∏ –ë—ç–∫—Ç–µ—Å—Ç–∞                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Total Trades        ‚îÇ 156               ‚îÇ ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å > 30
‚îÇ Final Equity        ‚îÇ $12,450.50        ‚îÇ
‚îÇ Total PnL           ‚îÇ $2,450.50         ‚îÇ ‚Üê –î–æ–ª–∂–µ–Ω –±—ã—Ç—å > 0
‚îÇ Return (%)          ‚îÇ 24.51%            ‚îÇ ‚Üê –•–æ—Ä–æ—à–æ –µ—Å–ª–∏ > 10%
‚îÇ Success Rate (%)    ‚îÇ 58.33%            ‚îÇ ‚Üê –•–æ—Ä–æ—à–æ –µ—Å–ª–∏ > 50%
‚îÇ Profit Factor       ‚îÇ 1.85              ‚îÇ ‚Üê –•–æ—Ä–æ—à–æ –µ—Å–ª–∏ > 1.5
‚îÇ Sharpe Ratio        ‚îÇ 1.42              ‚îÇ ‚Üê –•–æ—Ä–æ—à–æ –µ—Å–ª–∏ > 1.0
‚îÇ Max Drawdown (%)    ‚îÇ 12.34%            ‚îÇ ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å < 20%
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üö® –ö—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏

- ‚ùå **Total Trades < 30**: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–≤–æ–¥–æ–≤
- ‚ùå **Success Rate < 40%**: –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç —á–∞—â–µ
- ‚ùå **Max Drawdown > 30%**: –°–ª–∏—à–∫–æ–º —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
- ‚ùå **Sharpe Ratio < 0.5**: –†–∏—Å–∫ –Ω–µ –æ–ø—Ä–∞–≤–¥–∞–Ω –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é

### ‚úÖ –•–æ—Ä–æ—à–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

- ‚úÖ **Total Trades > 50**
- ‚úÖ **Success Rate > 55%**
- ‚úÖ **Profit Factor > 1.8**
- ‚úÖ **Sharpe Ratio > 1.5**
- ‚úÖ **Max Drawdown < 15%**

---

## 9Ô∏è‚É£ –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### ‚ùå "–ù–µ—Ç —Å–¥–µ–ª–æ–∫"

**–ü—Ä–æ–±–ª–µ–º–∞**: `Total Trades = 0`

**–†–µ—à–µ–Ω–∏—è**:
1. –û—Å–ª–∞–±—å—Ç–µ —É—Å–ª–æ–≤–∏—è –≤—Ö–æ–¥–∞:
   ```python
   "RSI": {"overbought": 60, "oversold": 40}  # –ë—ã–ª–æ 70/30
   ```
2. –£–º–µ–Ω—å—à–∏—Ç–µ Stop Loss:
   ```python
   risk_roi_percent=0.3  # –ë—ã–ª–æ 0.5
   ```

### ‚ùå "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫"

**–ü—Ä–æ–±–ª–µ–º–∞**: `Success Rate < 40%`

**–†–µ—à–µ–Ω–∏—è**:
1. –£–≤–µ–ª–∏—á—å—Ç–µ Take Profit:
   ```python
   target_roi_percent=1.5  # –ë—ã–ª–æ 0.8
   ```
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã EMA:
   ```python
   "EMA_TREND": {"fast_len": 13, "slow_len": 34}  # –ë—ã–ª–æ 9/21
   ```

### ‚ùå "–ë–æ–ª—å—à–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞"

**–ü—Ä–æ–±–ª–µ–º–∞**: `Max Drawdown > 25%`

**–†–µ—à–µ–Ω–∏—è**:
1. –£–º–µ–Ω—å—à–∏—Ç–µ –ø–ª–µ—á–æ:
   ```python
   leverage=5.0  # –ë—ã–ª–æ 10.0
   ```
2. –£–∂–µ—Å—Ç–æ—á—å—Ç–µ Stop Loss:
   ```python
   risk_roi_percent=0.3  # –ë—ã–ª–æ 0.5
   ```

---

## üîü –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º

- [ ] –§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç > 1000 —Å—Ç—Ä–æ–∫
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: `pip install pandas numpy numba talib rich matplotlib`
- [ ] –í—ã–±—Ä–∞–Ω `RUN_MODE` ("SINGLE" –∏–ª–∏ "OPTIMIZE")
- [ ] –£–∫–∞–∑–∞–Ω `TARGET_CONFIG_NAME`

### –î–ª—è –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞

- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ `STRATEGY_CONFIGS`
- [ ] `initial_capital`, `leverage`, `target_roi_percent`, `risk_roi_percent` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –í—ã–±—Ä–∞–Ω—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤ `indicator_set`

### –î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ `PARAMETER_SPACE` —Å —Ä–∞–∑—É–º–Ω—ã–º–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏
- [ ] –í—ã–±—Ä–∞–Ω–∞ `OPTIMIZATION_METRIC`
- [ ] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –ø—Ä–∏–µ–º–ª–µ–º–æ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è < 500)

---

## üéì –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

### 1. –ù–∞—á–Ω–∏—Ç–µ —Å –º–∞–ª–æ–≥–æ

```python
# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ - –ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
indicator_set={
    "EMA_TREND": {"fast_len": 9, "slow_len": 21},
    "RSI": {"rsi_len": 14},
}
```

### 2. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è–π—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å

```python
# –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –¥–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã
indicator_set={
    "EMA_TREND": {"fast_len": 9, "slow_len": 21},
    "RSI": {"rsi_len": 14},
    "ATR_EXIT": {"atr_len": 14, "atr_multiplier": 1.5},  # –ù–æ–≤–æ–µ
    "MACD": {"fast_len": 12, "slow_len": 26, "signal_len": 9},  # –ù–æ–≤–æ–µ
}
```

### 3. –°—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é 3 —Ä–∞–∑–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏:
1. `OPTIMIZATION_METRIC = "Sharpe Ratio"` - –ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å
2. `OPTIMIZATION_METRIC = "Total PnL"` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å
3. `OPTIMIZATION_METRIC = "Max Drawdown (%)"` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫

–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Ö–æ—Ä–æ—à–∞ –ø–æ –≤—Å–µ–º –º–µ—Ç—Ä–∏–∫–∞–º.

### 4. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–∞—Ö

```python
# –¢–µ—Å—Ç 1: –ë—ã—á–∏–π —Ä—ã–Ω–æ–∫ (2023 –≥–æ–¥)
FILE_PATH = "data/BTC_USDT_1m_2023-01-01_to_2023-12-31.csv"

# –¢–µ—Å—Ç 2: –ú–µ–¥–≤–µ–∂–∏–π —Ä—ã–Ω–æ–∫ (2022 –≥–æ–¥)
FILE_PATH = "data/BTC_USDT_1m_2022-01-01_to_2022-12-31.csv"

# –¢–µ—Å—Ç 3: –ë–æ–∫–æ–≤–∏–∫ (–≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–µ—Ä–∏–æ–¥)
FILE_PATH = "data/BTC_USDT_1m_2024-06-01_to_2024-09-01.csv"
```

–•–æ—Ä–æ—à–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **–≤—Å–µ—Ö —Ç–∏–ø–∞—Ö —Ä—ã–Ω–∫–∞**.

---

## üìû –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

–°–∏—Å—Ç–µ–º–∞ –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

```
--- –ó–ê–ü–£–°–ö –°–ò–°–¢–ï–ú–´ –ë–≠–ö–¢–ï–°–¢–ê ---
[LOADER] –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ 89281 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö
--- INFO: –ù–∞—á–∏–Ω–∞–µ–º —Ä–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤. –ò—Å—Ö–æ–¥–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫: 89281
--- DEBUG: –†–∞—Å—Å—á–∏—Ç–∞–Ω—ã EMAs (fast=9, slow=21)
--- DEBUG: –†–∞—Å—Å—á–∏—Ç–∞–Ω RSI (len=14)
--- INFO: –†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω. –°—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ NaN: 89261
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É - –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ–Ω–æ —É–∫–∞–∂–µ—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (30 —Å–µ–∫—É–Ω–¥)

1. –û—Ç–∫—Ä–æ–π—Ç–µ `backtest_optana_v4.py`
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
   ```python
   RUN_MODE = "SINGLE"
   TARGET_CONFIG_NAME = "EMA_RSI_ATR_Strategy"
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
   ```bash
   python -m backtest.core.backtest_optana_v4
   ```
4. –°–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã! üìä

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏! üéâ