# üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –ø—Ä–æ–±–ª–µ–º

### ‚ùå –í–∞—à–∞ –æ—à–∏–±–∫–∞:
```
numba.core.errors.TypingError: Failed in nopython mode pipeline
>>> array(list(array(float64, 1d, C))<iv=None>)
array(float64, 1d, C) not allowed in a homogeneous sequence
```

### ‚úÖ –ü—Ä–∏—á–∏–Ω–∞:
Numba –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —Å–ø–∏—Å–∫–∞–º–∏ –º–∞—Å—Å–∏–≤–æ–≤ (`trades.append(np.array([...]))`).

### ‚úÖ –†–µ—à–µ–Ω–∏–µ:
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–ª–ª–æ–∫–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (3 —à–∞–≥–∞)

### –®–∞–≥ 1: –°–∫–∞—á–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

–ò–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ Claude —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤:

1. **backtest_optana_v4_fixed.py** ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `backtest_optana_v4.py`
2. **analysis.py - –ò–°–ü–†–ê–í–õ–ï–ù–û** ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `analysis.py`
3. **persistence.py - –ò–°–ü–†–ê–í–õ–ï–ù–û** ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `persistence.py`

### –®–∞–≥ 2: –ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª—ã

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
cd backtest/core/
cp backtest_optana_v4.py backtest_optana_v4.py.backup
cp analysis.py analysis.py.backup
cp persistence.py persistence.py.backup

# –ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
# (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ Claude)
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç
python -m backtest.core.backtest_optana_v4
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
--- –ó–ê–ü–£–°–ö –°–ò–°–¢–ï–ú–´ –ë–≠–ö–¢–ï–°–¢–ê ---
[LOADER] –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ 89281 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö
--- INFO: –ù–∞—á–∏–Ω–∞–µ–º —Ä–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤...
--- DEBUG: –†–∞—Å—Å—á–∏—Ç–∞–Ω—ã EMAs (fast=9, slow=21)
--- DEBUG: –†–∞—Å—Å—á–∏—Ç–∞–Ω RSI (len=14)
--- INFO: –†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω

--- –†–ï–ó–£–õ–¨–¢–ê–¢–´ –û–î–ò–ù–û–ß–ù–û–ì–û –ü–†–û–ì–û–ù–ê ---
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ       –ú–µ—Ç—Ä–∏–∫–∏ –ë—ç–∫—Ç–µ—Å—Ç–∞                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Total Trades        ‚îÇ 156             ‚îÇ
‚îÇ Sharpe Ratio        ‚îÇ 1.42            ‚îÇ  ‚Üê –î–û–õ–ñ–ù–û –ü–û–Ø–í–ò–¢–¨–°–Ø
‚îÇ ...                 ‚îÇ ...             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```
backtest/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ backtest_optana_v4.py     ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù
‚îÇ   ‚îú‚îÄ‚îÄ analysis.py               ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù
‚îÇ   ‚îú‚îÄ‚îÄ persistence.py            ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù
‚îÇ   ‚îú‚îÄ‚îÄ config.py                 ‚ö™ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô
‚îÇ   ‚îú‚îÄ‚îÄ data_loader.py            ‚ö™ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô
‚îÇ   ‚îî‚îÄ‚îÄ indicators.py             ‚ö™ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ BTC_USDT_1m_...csv
‚îî‚îÄ‚îÄ docs/                         ‚ú® –ù–û–í–û–ï
    ‚îú‚îÄ‚îÄ README.md                 ‚ú® –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ QUICK_START.md            ‚ú® –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
    ‚îú‚îÄ‚îÄ CHANGELOG.md              ‚ú® –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    ‚îî‚îÄ‚îÄ INSTALLATION.md           ‚ú® –≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
```

---

## üîç –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. –í `backtest_optana_v4.py`

#### –î–æ (‚ùå –û–®–ò–ë–ö–ê):
```python
@njit
def _numba_backtest_core(...):
    trades = []  # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫
    
    # –í —Ü–∏–∫–ª–µ:
    trade_record = np.array((exit_index, entry_index, ...))
    trades.append(trade_record)  # ‚ùå Numba –Ω–µ –º–æ–∂–µ—Ç —ç—Ç–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å
    
    # –í –∫–æ–Ω—Ü–µ:
    trades_array = np.array(trades)  # ‚ùå –û–®–ò–ë–ö–ê
    return trades_array, current_equity
```

#### –ü–æ—Å–ª–µ (‚úÖ –†–ê–ë–û–¢–ê–ï–¢):
```python
@njit
def _numba_backtest_core(...):
    # –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–ª–ª–æ–∫–∞—Ü–∏—è –º–∞—Å—Å–∏–≤–∞
    max_trades = num_bars
    trades_array = np.zeros((max_trades, 8), dtype=np.float64)
    trade_count = 0
    
    # –í —Ü–∏–∫–ª–µ:
    trades_array[trade_count, 0] = exit_index
    trades_array[trade_count, 1] = entry_index
    # ... –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π ...
    trade_count += 1
    
    # –í –∫–æ–Ω—Ü–µ: –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ª—å–∫–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é —á–∞—Å—Ç—å
    return trades_array[:trade_count], current_equity
```

### 2. –í `analysis.py`

#### –î–æ–±–∞–≤–ª–µ–Ω–æ (‚úÖ –ù–û–í–û–ï):
```python
def calculate_metrics(...):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
    
    # ===== –î–û–ë–ê–í–õ–ï–ù–û: –†–∞—Å—á–µ—Ç Sharpe Ratio =====
    if num_trades > 1:
        if "pnl_perc" in trades_df.columns:
            returns = trades_df["pnl_perc"].values
        else:
            equity_with_initial = np.concatenate([[initial_capital], 
                                                   equity_curve.values[:-1]])
            returns = (equity_curve.values - equity_with_initial) / equity_with_initial
        
        mean_return = np.mean(returns)
        std_return = np.std(returns, ddof=1)
        
        if std_return > 0:
            sharpe_ratio = mean_return / std_return * np.sqrt(252)
        else:
            sharpe_ratio = 0.0
    else:
        sharpe_ratio = 0.0
    
    metrics["Sharpe Ratio"] = sharpe_ratio  # ‚Üê –ù–û–í–ê–Ø –ú–ï–¢–†–ò–ö–ê
```

### 3. –í `persistence.py`

#### –î–æ–±–∞–≤–ª–µ–Ω–æ (‚úÖ –ù–û–í–û–ï):
```python
def persist_optimization_result(...):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
    
    record["Sharpe_Ratio"] = best_metrics.get("Sharpe Ratio")  # ‚Üê –ù–û–í–û–ï
    
    # ... —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ CSV/SQLite/TXT ...
```

---

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø—É–Ω–∫—Ç—ã:

### –ë–∞–∑–æ–≤–∞—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å:
- [ ] –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV
- [ ] –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (EMA, RSI, ATR)
- [ ] –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ç–∫—Ç–µ—Å—Ç (–ø–æ—è–≤–ª—è—é—Ç—Å—è —Å–¥–µ–ª–∫–∏)

### –ú–µ—Ç—Ä–∏–∫–∏:
- [ ] –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è **Sharpe Ratio**
- [ ] –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- [ ] –ì—Ä–∞—Ñ–∏–∫ —ç–∫–≤–∏—Ç–∏ –∏ –ø—Ä–æ—Å–∞–¥–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã:
- [ ] **SINGLE** —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç (–æ–¥–∏–Ω –ø—Ä–æ–≥–æ–Ω —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏)
- [ ] **OPTIMIZE** —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–µ—Ä–µ–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç (CSV/SQLite/TXT)

---

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "ModuleNotFoundError: No module named 'backtest'"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
cd /path/to/your/project
python -m backtest.core.backtest_optana_v4

# –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
pip install -e .
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "Cannot find data file"

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –í config.py –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º:
FILE_PATH = SCRIPT_DIR / "backtest/data/BTC_USDT_1m_...csv"

# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
print(FILE_PATH)
print(FILE_PATH.exists())  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å True
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Numba –≤—Å—ë –µ—â—ë –≤—ã–¥–∞—ë—Ç –æ—à–∏–±–∫—É

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ –∑–∞–º–µ–Ω–∏–ª–∏ —Ñ–∞–π–ª `backtest_optana_v4.py`
2. Python –∫—ç—à–∏—Ä–æ–≤–∞–ª —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–¥–∞–ª–∏—Ç–µ –∫—ç—à Python
find . -type d -name "__pycache__" -exec rm -rf {} +
find . -type f -name "*.pyc" -delete

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Python
python -m backtest.core.backtest_optana_v4
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: "Sharpe Ratio = 0.0" –∏–ª–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –°–ª–∏—à–∫–æ–º –º–∞–ª–æ —Å–¥–µ–ª–æ–∫ (< 2)
2. –ù–µ –∑–∞–º–µ–Ω–∏–ª–∏ —Ñ–∞–π–ª `analysis.py`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
# –ï—Å–ª–∏ Total Trades < 2, –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
```

---

## üìö –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

### 1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- **README.md** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–∏—Å—Ç–µ–º–µ
- **QUICK_START.md** - –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞ 5 –º–∏–Ω—É—Ç

### 2. –°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
```python
# –í backtest_optana_v4.py:
STRATEGY_CONFIGS = {
    "My_First_Strategy": StrategyConfig(
        initial_capital=10000.0,
        leverage=10.0,
        target_roi_percent=1.0,
        risk_roi_percent=0.5,
        indicator_set={
            "EMA_TREND": {"fast_len": 9, "slow_len": 21},
            "RSI": {"rsi_len": 14},
        },
    ),
}

TARGET_CONFIG_NAME = "My_First_Strategy"
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é
```python
RUN_MODE = "OPTIMIZE"
OPTIMIZATION_METRIC = "Sharpe Ratio"

PARAMETER_SPACE = {
    "EMA_TREND": {
        "fast_len": [5, 9, 13],
        "slow_len": [21, 34, 50],
    },
}
```

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
python -m backtest.core.backtest_optana_v4

# –ó–∞–ø—É—Å–∫ —Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –≤—ã–≤–æ–¥–∞ –≤ —Ñ–∞–π–ª
python -m backtest.core.backtest_optana_v4 > results.log 2>&1

# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (Linux/Mac)
nohup python -m backtest.core.backtest_optana_v4 &

# –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
time python -m backtest.core.backtest_optana_v4
```

---

## üìä –û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|-------|------------|
| –ü–µ—Ä–≤–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è Numba | 5-10 —Å–µ–∫ | –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ |
| –û–¥–∏–Ω –±—ç–∫—Ç–µ—Å—Ç | 0.1-0.5 —Å–µ–∫ | –ü–æ—Å–ª–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ |
| –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (72 –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏) | 10-30 —Å–µ–∫ | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–∞–Ω–Ω—ã—Ö |
| –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (90k —Å—Ç—Ä–æ–∫) | 1-2 —Å–µ–∫ | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–∏—Å–∫–∞ |

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É:

```bash
python -c "
from backtest.core.backtest_optana_v4 import main
from backtest.core.analysis import calculate_metrics
import pandas as pd
import numpy as np

# –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
print('‚úÖ –ò–º–ø–æ—Ä—Ç—ã —É—Å–ø–µ—à–Ω—ã')

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Numba
from numba import njit
@njit
def test_func():
    arr = np.zeros((10, 5))
    return arr
result = test_func()
print(f'‚úÖ Numba —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞: {result.shape}')

print('‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã!')
"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
‚úÖ –ò–º–ø–æ—Ä—Ç—ã —É—Å–ø–µ—à–Ω—ã
‚úÖ Numba —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞: (10, 5)
‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã!
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
   ```bash
   pip list | grep -E "(pandas|numpy|numba|talib)"
   ```

2. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–º–µ–Ω–µ–Ω—ã:**
   ```bash
   grep -n "–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï" backtest/core/backtest_optana_v4.py
   # –î–æ–ª–∂–Ω–æ –Ω–∞–π—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å "–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï"
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
   - –ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ —Å `[ERROR]` –∏–ª–∏ `WARNING`
   - –ß–∏—Ç–∞–π—Ç–µ —Ç—Ä–µ–π—Å–±–µ–∫ –æ—à–∏–±–æ–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫ Numba
- ‚úÖ –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç Sharpe Ratio
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ò–º–µ–µ—Ç –ø–æ–ª–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–£—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π! üöÄüìà**